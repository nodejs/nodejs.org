import Badge from '@node-core/ui-components/Common/Badge';
import { useTranslations } from 'next-intl';
import type { FC } from 'react';

import styles from './index.module.css';

export const SEVERITY_ORDER = ['critical', 'high', 'medium', 'low'] as const;

const SEVERITY_KIND_MAP = {
  unknown: 'neutral',
  low: 'default',
  medium: 'info',
  high: 'warning',
  critical: 'error',
} as const;

type VulnerabilityChipProps = {
  severity: keyof typeof SEVERITY_KIND_MAP;
  count?: number;
};

const VulnerabilityChip: FC<VulnerabilityChipProps> = ({
  severity,
  count = 0,
}) => {
  const t = useTranslations();

  return (
    <Badge size="small" kind={SEVERITY_KIND_MAP[severity]} className="mr-1">
      {count > 0 ? <span className={styles.chipCount}>{count}</span> : null}
      {t(`components.eolChip.severity.${severity}`)}
    </Badge>
  );
};

export default VulnerabilityChip;
